%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                         Example Parameters 1                        %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                         %
% * Adapted from:                                                         %
%   L. Xie, Y.C. Soh, C. de Souza. Robust Kalman Filtering for Uncertain  %
%   Discrete-Time Systems. IEEE Trans. Automat. Control. 39 (6) (1994).   % 
%                                                                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                    System and Sensing Model Data                    %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ======================================================================= %
% Target system
% ======================================================================= %

% Model:

% x(k+1) = (F+dF)(k)x(k) + (G+dG)(k)u(k) + (H+dH)(k)w(k)

% [dF(k) dG(k) dH(k)] = M1(k) D1(k) [EF(k) EG(k) EH(k)];    ||D1(k)|| <= 1

% w(k) ~ N(0,Qk) - System noise

% ----------------------------------------------------------------------- %
% Initial state
% ----------------------------------------------------------------------- %

x0 = [2;
      1];

% ----------------------------------------------------------------------- %
% Input vector
% ----------------------------------------------------------------------- %

u_k = 0;

% ----------------------------------------------------------------------- %
% Nominal parameter matrices
% ----------------------------------------------------------------------- %

F = [0 -0.5;
     1   1 ];

G = [0;
     0];

H = [-6;
      1];
  
Q = 1;

% ----------------------------------------------------------------------- %
% Uncertain parameter matrices
% ----------------------------------------------------------------------- %

M1 = [ 0;
      10];

EF = [0.01 0.03];

EG = 0;

EH = 0.01;

% ======================================================================= %
% Sensing model
% ======================================================================= %

% Model:

% y(k) = (C+dC)(k)x(k) + (D+dD)(k)v(k)

% [dC(k) dD(k)] = M2(k) D2(k) [EC(k) ED(k)];    ||D2(k)|| <= 1

% v(k) ~ N(0,Rk) - Sensor noise

% ----------------------------------------------------------------------- %
% Nominal parameter matrices
% ----------------------------------------------------------------------- %

C = [-100 10];

D = 1;

R = 1;

% ----------------------------------------------------------------------- %
% Uncertain parameter matrices
% ----------------------------------------------------------------------- %

M2 = 10;

EC = EF;

ED = EH;

% ======================================================================= %
% System model structure
% ======================================================================= %

sys_model = struct();

sys_model.F = F;
sys_model.G = G;
sys_model.H = H;
sys_model.Q = Q;

sys_model.C = C;
sys_model.D = D;
sys_model.R = R;

sys_model.M1 = M1;
sys_model.EF = EF;
sys_model.EG = EG;
sys_model.EH = EH;

sys_model.M2 = M2;
sys_model.EC = EC;
sys_model.ED = ED;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
